# =============================================================================
# åŸºæœ¬è¨­å®š
# =============================================================================

# ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚­ãƒ¼: Ctrl+A
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—é…å»¶ã‚’ãªãã™ï¼ˆVimç”¨ï¼‰
set -sg escape-time 0

# 256è‰² + True Colorå¯¾å¿œ
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨ãƒšãƒ¼ãƒ³ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’1ã‹ã‚‰é–‹å§‹
set -g base-index 1
setw -g pane-base-index 1

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ãŸã¨ãã«ç•ªå·ã‚’è©°ã‚ã‚‹
set -g renumber-windows on

# ãƒ’ã‚¹ãƒˆãƒªã‚µã‚¤ã‚º
set -g history-limit 50000

# =============================================================================
# ãƒã‚¦ã‚¹è¨­å®š
# =============================================================================

set -g mouse on

# ãƒã‚¦ã‚¹ã§ãƒšãƒ¼ãƒ³å¢ƒç•Œã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ãƒªã‚µã‚¤ã‚º
bind -n MouseDrag1Border resize-pane -M

# ãƒã‚¦ã‚¹ã§ãƒšãƒ¼ãƒ³ã‚’é¸æŠ
bind -n MouseDown1Pane select-pane -t= \; send-keys -M

# ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§å˜èªé¸æŠï¼†ã‚³ãƒ”ãƒ¼
bind -n DoubleClick1Pane select-pane \; copy-mode -M \; send-keys -X select-word \; run-shell -d0.3 \; send-keys -X copy-pipe-and-cancel 'pbcopy'

# =============================================================================
# ã‚³ãƒ”ãƒ¼ãƒ¢ãƒ¼ãƒ‰ï¼ˆVié¢¨ï¼‰
# =============================================================================

setw -g mode-keys vi

# é¸æŠãƒ»ã‚³ãƒ”ãƒ¼
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel 'pbcopy'
bind-key -T copy-mode-vi C-v send -X rectangle-toggle
bind-key -T copy-mode-vi Y send -X copy-line

# ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•
bind-key -T copy-mode-vi h send -X cursor-left
bind-key -T copy-mode-vi j send -X cursor-down
bind-key -T copy-mode-vi k send -X cursor-up
bind-key -T copy-mode-vi l send -X cursor-right

# ãƒšãƒ¼ã‚¸ç§»å‹•
bind-key -T copy-mode-vi C-u send -X halfpage-up
bind-key -T copy-mode-vi C-d send -X halfpage-down
bind-key -T copy-mode-vi C-b send -X page-up
bind-key -T copy-mode-vi C-f send -X page-down

# å˜èªç§»å‹•
bind-key -T copy-mode-vi w send -X next-word
bind-key -T copy-mode-vi b send -X previous-word
bind-key -T copy-mode-vi e send -X next-word-end

# è¡Œé ­ãƒ»è¡Œæœ«
bind-key -T copy-mode-vi 0 send -X start-of-line
bind-key -T copy-mode-vi $ send -X end-of-line
bind-key -T copy-mode-vi ^ send -X back-to-indentation

# æ¤œç´¢
bind-key -T copy-mode-vi / send -X search-forward
bind-key -T copy-mode-vi ? send -X search-backward
bind-key -T copy-mode-vi n send -X search-again
bind-key -T copy-mode-vi N send -X search-reverse

# =============================================================================
# ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
# =============================================================================

bind C command-prompt -p "New Session:" "new-session -A -s '%%'"
bind C-j switch-client -n
bind C-k switch-client -p
bind Q confirm-before -p "Kill #S (y/n)?" "run-shell 'tmux switch-client -n \\\; kill-session -t \"#S\"'"

# =============================================================================
# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»ãƒšãƒ¼ãƒ³æ“ä½œ
# =============================================================================

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½œæˆï¼ˆç¾åœ¨ã®ãƒ‘ã‚¹ã‚’ç¶­æŒï¼‰
bind c new-window -c "#{pane_current_path}"

# ãƒšãƒ¼ãƒ³åˆ†å‰²ï¼ˆç¾åœ¨ã®ãƒ‘ã‚¹ã‚’ç¶­æŒï¼‰
bind -n C-\\ split-window -h -c "#{pane_current_path}"
bind -n C-- split-window -v -c "#{pane_current_path}"

# ãƒšãƒ¼ãƒ³é–“ç§»å‹•ï¼ˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã—ï¼‰
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# ãƒšãƒ¼ãƒ³ãƒªã‚µã‚¤ã‚º
bind -r h resize-pane -L 2
bind -r j resize-pane -D 2
bind -r k resize-pane -U 2
bind -r l resize-pane -R 2

bind -r H resize-pane -L 10
bind -r J resize-pane -D 10
bind -r K resize-pane -U 10
bind -r L resize-pane -R 10

# ãƒšãƒ¼ãƒ³ã‚’é–‰ã˜ã‚‹
bind -n C-q kill-pane

# ãƒšãƒ¼ãƒ³ç•ªå·è¡¨ç¤º
bind -r C-g display-panes
set -g display-panes-time 10000

# ãƒšãƒ¼ãƒ³åŒæœŸï¼ˆåŒæ™‚å…¥åŠ›ï¼‰
bind S setw synchronize-panes \; display "Sync: #{?synchronize-panes,ON,OFF}"

# ãƒšãƒ¼ãƒ³ã‚’ã‚ºãƒ¼ãƒ 
bind z resize-pane -Z

# ãƒšãƒ¼ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåˆ‡ã‚Šæ›¿ãˆ
bind Space next-layout

# =============================================================================
# ä¾¿åˆ©æ©Ÿèƒ½
# =============================================================================

# è¨­å®šãƒªãƒ­ãƒ¼ãƒ‰
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# URLã‚’é–‹ãï¼ˆmacOSï¼‰
bind u run-shell "tmux capture-pane -p | grep -oE 'https?://[^ ]+' | fzf --reverse | xargs open"

# =============================================================================
# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ï¼ˆNordé¢¨ï¼‰
# =============================================================================

set -g status-position bottom
set -g status-interval 1
set -g status-justify left

# èƒŒæ™¯ãƒ»å‰æ™¯
set -g status-style 'bg=#2e3440,fg=#d8dee9'

# å·¦å´: ã‚»ãƒƒã‚·ãƒ§ãƒ³å
set -g status-left-length 30
set -g status-left '#[bg=#5e81ac,fg=#eceff4,bold] #S #[bg=#2e3440] '

# å³å´: æ—¥æ™‚
set -g status-right-length 50
set -g status-right '#[fg=#4c566a]â”‚ #[fg=#a3be8c]#{pane_current_path} #[fg=#4c566a]â”‚ #[fg=#88c0d0]%m/%d %H:%M '

# ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚¹ãƒˆ
setw -g window-status-format '#[fg=#4c566a] #I:#W '
setw -g window-status-current-format '#[bg=#4c566a,fg=#eceff4,bold] #I:#W#{?window_zoomed_flag,ğŸ”,} '
setw -g window-status-separator ''

# ãƒšãƒ¼ãƒ³ãƒœãƒ¼ãƒ€ãƒ¼
set -g pane-border-style 'fg=#4c566a'
set -g pane-active-border-style 'fg=#5e81ac'

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
set -g message-style 'bg=#5e81ac,fg=#eceff4,bold'

# =============================================================================
# TPMï¼ˆtmux Plugin Managerï¼‰
# =============================================================================

# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'    # ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜ãƒ»å¾©å…ƒ
set -g @plugin 'tmux-plugins/tmux-continuum'    # è‡ªå‹•ä¿å­˜
set -g @plugin 'sainnhe/tmux-fzf'               # fzfã§tmuxæ“ä½œ
set -g @plugin 'tmux-plugins/tmux-yank'         # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰é€£æº

# tmux-fzfè¨­å®š
TMUX_FZF_LAUNCH_KEY="f"
TMUX_FZF_ORDER="session|window|pane|command|keybinding"

# tmux-resurrectè¨­å®š
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'

# tmux-continuumè¨­å®š
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# TPMåˆæœŸåŒ–ï¼ˆã“ã®è¡Œã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¾Œã«é…ç½®ï¼‰
run '~/.tmux/plugins/tpm/tpm'
